<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quotes Management</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container mt-5">
  <h2>Quotes</h2>
    <form id="createQuoteForm" class="mb-4">
      <div class="mb-3">
        <label for="quoteDescription" class="form-label">Description</label>
        <textarea class="form-control" id="quoteDescription" rows="3" required></textarea>
      </div>
      <button type="submit" class="btn btn-primary">Create Quote</button>
    </form>

    <!-- Quotes List -->
    <h2>All Quotes</h2>
    <ul id="quotesList" class="list-group mb-4"></ul>

    <!-- Update Quote Form -->
    <form id="updateQuoteForm" style="display:none;" class="mb-4">
      <input type="hidden" id="updateQuoteId">
      <div class="mb-3">
        <label for="updateQuoteDescription" class="form-label">Description</label>
        <textarea class="form-control" id="updateQuoteDescription" rows="3" required></textarea>
      </div>
      <button type="submit" class="btn btn-success">Update Quote</button>
      <button type="button" id="cancelUpdate" class="btn btn-secondary">Cancel</button>
    </form>
  </div>

  <script>
const api_endpoint = 'https://fof-website-upgrade-api.onrender.com/quote';

// Fetch and display all quotes
async function fetchQuotes() {
  const res = await fetch(api_endpoint);
  const quotes = await res.json();
  const list = document.getElementById('quotesList');
  list.innerHTML = '';
  quotes.forEach(quote => {
    const li = document.createElement('li');
    li.className = 'list-group-item d-flex justify-content-between align-items-center';
    li.innerHTML = `
      <span>
        <em>Description:</em> ${quote.description}
      </span>
      <span>
        <button class="btn btn-sm btn-info me-2 quote-edit" data-id="${quote.id}" data-description="${encodeURIComponent(quote.description)}">Edit</button>
        <button class="btn btn-sm btn-danger" onclick="deleteQuote('${quote.id}')">Delete</button>
      </span>
    `;
    list.appendChild(li);
  });
  // Attach event listeners for edit buttons
  document.querySelectorAll('.quote-edit').forEach(btn => {
    btn.onclick = function() {
      const id = btn.getAttribute('data-id');
      const description = decodeURIComponent(btn.getAttribute('data-description'));
      showUpdateForm(id, description);
    };
  });
}

// Create quote
const createForm = document.getElementById('createQuoteForm');
createForm.addEventListener('submit', async (e) => {
  e.preventDefault();
  const description = document.getElementById('quoteDescription').value;
  await fetch(api_endpoint, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ description })
  });
  createForm.reset();
  fetchQuotes();
});

// Show update form
window.showUpdateForm = function(id, description) {
  const updateForm = document.getElementById('updateQuoteForm');
  updateForm.style.display = 'block';
  updateForm.reset();
  document.getElementById('updateQuoteId').value = id;
  document.getElementById('updateQuoteDescription').value = description;
};

document.getElementById('cancelUpdate').onclick = function() {
  document.getElementById('updateQuoteForm').style.display = 'none';
};

// Update quote
const updateForm = document.getElementById('updateQuoteForm');
updateForm.addEventListener('submit', async (e) => {
  e.preventDefault();
  const id = document.getElementById('updateQuoteId').value;
  const description = document.getElementById('updateQuoteDescription').value;
  await fetch(`${api_endpoint}/${id}`, {
    method: 'PUT',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ description })
  });
  updateForm.reset();
  updateForm.style.display = 'none';
  fetchQuotes();
});

// Delete quote
window.deleteQuote = async function(id) {
  await fetch(`${api_endpoint}/${id}`, { method: 'DELETE' });
  fetchQuotes();
};

// Initial load
fetchQuotes();
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
